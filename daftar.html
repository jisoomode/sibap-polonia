<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Pendaftaran BAP | SIBAP Polonia</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f5f7fa;margin:0}
.container{max-width:800px;margin:40px auto;background:#fff;padding:30px;border-radius:8px}
h2{margin-bottom:20px}
label{font-weight:bold;margin-top:15px;display:block}
input,select{width:100%;padding:10px;margin-top:6px;border:1px solid #ccc;border-radius:4px}
.file-box{background:#f1f1f1;padding:15px;border-radius:6px;margin-top:10px}
button{margin-top:25px;padding:12px;background:#0b5ed7;color:#fff;border:none;border-radius:5px;font-size:16px;cursor:pointer}
button:hover{background:#084298}
</style>
</head>

<body>
<div class="container">
<h2>Form Pendaftaran BAP</h2>

<form id="formDaftar">

<label>Tanggal BAP</label>
<input type="text" id="tanggalBAP" readonly>

<label>Nama Lengkap</label>
<input type="text" required>

<label>NIK</label>
<input type="text" required>

<label>Nomor HP Aktif</label>
<input type="text" required>

<label>Jenis Permohonan</label>
<select id="jenis" required>
  <option value="">-- Pilih --</option>
  <option value="hilang">Paspor Hilang</option>
  <option value="rusak">Paspor Rusak</option>
  <option value="perubahan">Perubahan Data</option>
</select>

<div id="berkas"></div>

<button type="submit">Daftar</button>
</form>
</div>

<script>
// ================= AMBIL TANGGAL DARI URL =================
const params = new URLSearchParams(window.location.search);
let tanggal = params.get("tanggal");

if(!tanggal){
  document.body.innerHTML="<h2 style='text-align:center'>Tanggal tidak valid</h2>";
  throw new Error("Tanggal kosong");
}

tanggal = decodeURIComponent(tanggal);
document.getElementById("tanggalBAP").value = tanggal;

// ================= ATUR BERKAS =================
const berkasDiv = document.getElementById("berkas");
const jenis = document.getElementById("jenis");

jenis.addEventListener("change", ()=>{
  berkasDiv.innerHTML = "";
  let html = "";

  if(jenis.value==="hilang"){
    html = `
    <div class="file-box">
      <b>Dokumen Wajib</b>
      <input type="file" required> KTP<br><br>
      <input type="file" required> KK<br><br>
      <input type="file" required> Akte Lahir<br><br>
      <input type="file" required> Surat Kehilangan Polisi<br><br>
      <input type="file" required> Halaman Data Paspor
    </div>
    <div class="file-box">
      <b>Berkas Pendukung</b>
      <input type="file"> Ijazah / Akte Nikah
    </div>`;
  }

  if(jenis.value==="rusak"){
    html = `
    <div class="file-box">
      <b>Dokumen Wajib</b>
      <input type="file" required> KTP<br><br>
      <input type="file" required> KK<br><br>
      <input type="file" required> Akte Lahir<br><br>
      <input type="file" required> Halaman Data Paspor
    </div>
    <div class="file-box">
      <b>Berkas Pendukung</b>
      <input type="file"> Ijazah / Akte Nikah
    </div>`;
  }

  if(jenis.value==="perubahan"){
    html = `
    <div class="file-box">
      <b>Dokumen Wajib</b>
      <input type="file" required> KTP<br><br>
      <input type="file" required> KK<br><br>
      <input type="file" required> Akte Lahir<br><br>
      <input type="file" required> Surat Penetapan Pengadilan
    </div>
    <div class="file-box">
      <b>Berkas Pendukung</b>
      <input type="file"> Ijazah / Akte Nikah
    </div>`;
  }

  berkasDiv.innerHTML = html;
});

// ================= SIMPAN KE ADMIN =================
document.getElementById("formDaftar").addEventListener("submit",()=>{
  let data = JSON.parse(localStorage.getItem("pendaftaran") || "[]");
  data.push({
    tanggal: tanggal,
    jenis: jenis.value,
    waktu: new Date().toLocaleString()
  });
  localStorage.setItem("pendaftaran",JSON.stringify(data));
  alert("Pendaftaran berhasil");
});
</script>
</body>
</html>

